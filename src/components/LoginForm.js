import React, { useState } from "react";
import TextField from "@mui/material/TextField";
import Typography from "@mui/material/Typography";
import Button from "@mui/material/Button";
import Divider from "@mui/material/Divider";
import { FcGoogle } from "react-icons/fc";
import { Link } from "react-router-dom";
import { authentication } from "./Firebase/firebase";
import { signInWithPopup, GoogleAuthProvider } from "firebase/auth";
import { v4 as uuidv4 } from "uuid";
import store from "./store";
import { loginFunc, logoutFunc } from "./actions/index";

const LoginForm = () => {
  const signInWithGoogle = () => {
    const provider = new GoogleAuthProvider();
    signInWithPopup(authentication, provider)
      .then((re) => {
        console.log(re);
      })
      .catch((err) => {
        console.log(err);
      });
  };
  const [user, setUser] = useState({
    userName: "",
    userId: uuidv4(),
    pwd: ""
  });
  function userChange(e) {
    const { name, value } = e.target;
    setUser((prevValue) => {
      return {
        ...prevValue,
        [name]: value
      };
    });
  }
  function handleUser() {
    console.log(user);
    store.dispatch(loginFunc(user.userId, user.userName));
  }
  return (
    <div className="form-box-wrapper">
      <div className="form-box">
        <Typography
          sx={{
            padding: "3%",
            color: "white",
            justifyContent: "centre",
            alignItems: "centre",
            fontSize: "1.5em",
            marginLeft: "auto",
            marginRight: "auto"
          }}
        >
          Sign In
        </Typography>
        <div>
          <TextField
            id="outlined-basic"
            label="Username"
            variant="outlined"
            name="userName"
            onChange={userChange}
            value={user.userName}
            sx={{
              "& label.Mui-focused": {
                color: "white"
              },
              "& .MuiInput-underline:after": {
                borderBottomColor: "black"
              },
              "& .MuiOutlinedInput-root": {
                "& fieldset": {
                  borderColor: "black"
                },
                "&:hover fieldset": {
                  borderColor: "black"
                },
                "&.Mui-focused fieldset": {
                  borderColor: "cyan"
                }
              }
            }}
          />
        </div>
        <br></br>
        <div>
          <TextField
            id="outlined-basic"
            label="Name"
            variant="outlined"
            sx={{
              "& label.Mui-focused": {
                color: "white"
              },
              "& .MuiInput-underline:after": {
                borderBottomColor: "black"
              },
              "& .MuiOutlinedInput-root": {
                "& fieldset": {
                  borderColor: "black"
                },
                "&:hover fieldset": {
                  borderColor: "black"
                },
                "&.Mui-focused fieldset": {
                  borderColor: "cyan"
                }
              }
            }}
          />
        </div>
        <br></br>
        <div>
          <TextField
            type="password"
            id="outlined-basic"
            label="Password"
            variant="outlined"
            name="pwd"
            onChange={userChange}
            value={user.pwd}
            sx={{
              "& label.Mui-focused": {
                color: "white"
              },
              "& .MuiInput-underline:after": {
                borderBottomColor: "black"
              },
              "& .MuiOutlinedInput-root": {
                "& fieldset": {
                  borderColor: "black"
                },
                "&:hover fieldset": {
                  borderColor: "black"
                },
                "&.Mui-focused fieldset": {
                  borderColor: "cyan"
                }
              }
            }}
          />
        </div>
        {/* <input type="submit" value="LOGIN" className="login-btn" /> */}
        <Button
          sx={{
            marginBottom: "2%",
            marginTop: "2%"
          }}
          component={Link}
          to="/"
          type="submit"
          variant="contained"
          onClick={handleUser}
        >
          SIGN IN
        </Button>
        <Button
          onClick={signInWithGoogle}
          startIcon={<FcGoogle />}
          sx={{
            marginBottom: "2%",
            marginTop: "2%",
            backgroundColor: "white",
            color: "black"
          }}
          type="submit"
          variant="contained"
        >
          SIGN IN WITH GOOGLE
        </Button>
        {/* <Button variant="contained">Contained</Button> */}
        <Divider
          sx={{
            marginBottom: "2%",
            marginTop: "2%"
          }}
        />
        <Button
          component={Link}
          to="/signup"
          sx={{ marginBottom: "5%" }}
          type="submit"
          variant="contained"
        >
          REGISTER
        </Button>
      </div>
    </div>
  );
};

export default LoginForm;
